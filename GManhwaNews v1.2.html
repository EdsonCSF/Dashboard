<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meleka Animes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&family=Luckiest+Guy&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js" defer></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Neue', cursive;
            background: #111 url('image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect fill="%23222" width="100" height="100"/><path d="M0,0 L100,100 M100,0 L0,100" stroke="%23333" stroke-width="1"/></svg>');
            color: #fff;
            line-height: 1.6;
            padding-bottom: 100px;
            position: relative;
        }

        /* Splash Screen ‚Äî COM ANIMA√á√ÉO DE SA√çDA GARANTIDA */
        .splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ff3040, #a12a5e, #64b5f6); /* üî¥ VERMELHO VIBRANTE no in√≠cio */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            text-align: center;
            opacity: 1;
            /* ‚úÖ ANIMA√á√ÉO CSS DE SA√çDA AUTOM√ÅTICA (FALLBACK) */
            animation: splashFadeOut 2.5s forwards;
        }

        @keyframes splashFadeOut {
            0%, 90% { opacity: 1; }
            100% { opacity: 0; visibility: hidden; }
        }

        .splash::before {
            content: "";
            position: absolute;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
            border-radius: 50%;
            filter: blur(20px);
            animation: shine 3s infinite alternate;
        }

        .splash::after {
            content: "";
            position: absolute;
            bottom: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 10%, transparent 70%);
            animation: pulse-bg 4s infinite;
        }

        @keyframes shine {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0.3; }
            100% { transform: translate(150%, 150%) scale(1.5); opacity: 0.8; }
        }

        @keyframes pulse-bg {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.05); opacity: 0.5; }
        }

        .splash-title {
            font-family: 'Luckiest Guy', cursive;
            font-size: 3.5rem;
            color: #fff;
            text-shadow: 4px 4px 0 #000, 0 0 20px rgba(255,255,255,0.8);
            margin-bottom: 1rem;
            position: relative;
            z-index: 2;
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            0% { text-shadow: 4px 4px 0 #000, 0 0 10px rgba(255,48,64,0.7); } /* üî¥ VERMELHO VIBRANTE */
            100% { text-shadow: 4px 4px 0 #000, 0 0 30px rgba(255,48,64,1); } /* üî¥ VERMELHO VIBRANTE */
        }

        /* ‚úÖ AQUI: "Meleka" em vermelho vibrante */
        .splash-title .meleka-highlight {
            color: #ff3040; /* üî¥ VERMELHO VIBRANTE */
            text-shadow: 4px 4px 0 #000, 0 0 20px rgba(255,48,64,0.8);
        }

        .splash-subtitle {
            font-size: 1.3rem;
            font-weight: bold;
            color: #fff;
            margin-bottom: 30px;
            position: relative;
            z-index: 2;
            text-shadow: 2px 2px 0 #000;
        }

        .progress-bar {
            width: 80%;
            max-width: 400px;
            height: 10px;
            background: rgba(0,0,0,0.3);
            border-radius: 50px;
            overflow: hidden;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.5);
            position: relative;
            z-index: 2;
        }

        .progress {
            height: 100%;
            width: 0;
            background: linear-gradient(90deg, #ff3040, #ffd54f, #ff6b35); /* üî¥ VERMELHO no in√≠cio */
            border-radius: 50px;
            animation: progress 2.3s ease-out forwards;
            box-shadow: 0 0 15px rgba(255,48,64,0.8);
        }

        @keyframes progress {
            0% { width: 0; }
            100% { width: 100%; }
        }

        /* Header estilo HQ */
        .header-hq {
            background: linear-gradient(135deg, #64b5f6, #b388ff);
            padding: 1.5rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            z-index: 10;
        }

        .header-hq::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 10%, transparent 10.5%);
            background-size: 20px 20px;
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .logo-container h1 {
            font-family: 'Luckiest Guy', cursive;
            font-size: 2.5rem;
            text-shadow: 4px 4px 0 #000;
            margin-bottom: 0.5rem;
        }

        /* ‚úÖ AQUI TAMB√âM: "Meleka" em vermelho vibrante no header */
        .meleka { 
            color: #ff3040; /* üî¥ VERMELHO VIBRANTE */
            text-shadow: 4px 4px 0 #000, 0 0 15px rgba(255,48,64,0.7);
        }
        .animes { color: #ffd54f; }

        .logo-container p {
            font-size: 1rem;
            margin-bottom: 1.5rem;
        }

        /* Bot√£o de volta para o Cinema */
        .cinema-cta {
            margin: 1.5rem 0 1rem;
            text-align: center;
        }

        .btn-cinema {
            display: inline-block;
            padding: 1rem 2.5rem;
            background: #ff6b35;
            color: #000;
            font-family: 'Luckiest Guy', cursive;
            font-size: 1.3rem;
            text-decoration: none;
            border: 4px double #ffd700;
            border-radius: 15px;
            transition: all 0.2s;
            box-shadow: 0 6px 0 #cc552a, 0 4px 8px rgba(0,0,0,0.3);
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-cinema:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 0 #cc552a, 0 6px 12px rgba(0,0,0,0.4);
            background: #ff8c55;
            border-color: #ffeb3b;
        }

        .btn-cinema:active {
            transform: translateY(2px);
            box-shadow: 0 3px 0 #cc552a, 0 2px 5px rgba(0,0,0,0.3);
        }

        /* Toolbar de Filtros */
        #toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 1.5rem 0;
            flex-wrap: wrap;
            gap: 1rem;
            padding: 0 1rem;
        }

        .filter-container {
            flex: 1;
            min-width: 250px;
        }

        select {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 3px double #ff3040; /* üî¥ Borda vermelha vibrante */
            background: #222;
            color: #fff;
            font-family: 'Comic Neue', cursive;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            min-width: 120px;
            transition: all 0.3s;
        }

        select:hover {
            border-color: #ffd54f;
            transform: scale(1.03);
        }

        #themeToggle {
            background: #222;
            border: 3px double #ff3040; /* üî¥ Borda vermelha vibrante */
            color: #fff;
            padding: 0.8rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        #themeToggle:hover {
            background: #ff3040; /* üî¥ Fundo vermelho vibrante ao passar mouse */
            color: #fff;
            transform: scale(1.05);
        }

        /* Cards estilo HQ */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        h2 {
            font-family: 'Luckiest Guy', cursive;
            font-size: 1.8rem;
            margin: 2rem 0 1.5rem;
            text-align: center;
            text-shadow: 3px 3px 0 #000;
            color: #ff3040; /* üî¥ T√≠tulo em vermelho vibrante */
            position: relative;
        }

        h2::after {
            content: "üç•";
            position: absolute;
            right: 10%;
            top: -10px;
            font-size: 1.5rem;
        }

        .items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 1.5rem;
        }

        .card-hq {
            background: #222;
            border: 4px double #64b5f6;
            border-radius: 15px;
            padding: 1rem;
            position: relative;
            overflow: hidden;
            opacity: 0;
            transform: translateY(30px);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .card-hq:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(100, 181, 246, 0.5);
        }

        .card-hq::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, #64b5f6, #b388ff, #ff3040); /* üî¥ Vermelho vibrante no final */
        }

        .card-img-container {
            height: 350px;
            overflow: hidden;
            border-radius: 10px;
            border: 3px solid #333;
            box-shadow: 0 5px 10px rgba(0,0,0,0.5);
            position: relative;
        }

        .card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .popularity-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
            z-index: 2;
            border: 2px solid #ff3040; /* üî¥ Borda vermelha vibrante */
        }

        .card-content {
            padding: 1rem 0 0;
        }

        .card h4 {
            font-family: 'Luckiest Guy', cursive;
            font-size: 1.3rem;
            margin: 0.5rem 0;
            color: #ffd54f;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-info {
            font-size: 0.9rem;
            color: #ccc;
            margin: 0.5rem 0;
        }

        .card-info p {
            margin: 0.25rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Loading e No Data */
        .loading, .no-data {
            text-align: center;
            padding: 3rem 1rem;
            font-size: 1.2rem;
            color: #ff3040; /* üî¥ Cor vermelha vibrante */
            grid-column: 1 / -1;
        }

        /* Bot√£o Carregar Mais */
        .btn-load-more {
            display: block;
            margin: 2rem auto 1rem;
            padding: 0.8rem 2rem;
            background: #a12a5e;
            color: white;
            font-family: 'Luckiest Guy', cursive;
            font-size: 1.1rem;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px double #ff3040; /* üî¥ Borda vermelha vibrante */
        }

        .btn-load-more:hover {
            background: #ff6b35;
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.6);
        }

        /* Bot√£o Voltar ao Topo */
        .btn-back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: #ff3040; /* üî¥ Fundo vermelho vibrante */
            color: #fff;
            border: 3px double #ffd700;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 100;
        }

        .btn-back-to-top.show {
            opacity: 1;
            visibility: visible;
        }

        .btn-back-to-top:hover {
            background: #ff6b35;
            transform: scale(1.1);
            box-shadow: 0 0 15px #ff3040;
        }

        /* Footer */
        footer {
            background: #000;
            color: #fff;
            padding: 2rem 0;
            margin-top: auto;
            border-top: 3px dashed #ff3040; /* üî¥ Borda vermelha vibrante */
            text-align: center;
            font-size: 0.85rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Responsivo */
        @media (max-width: 768px) {
            .splash-title { font-size: 2.5rem; }
            .logo-container h1 { font-size: 2rem; }
            #toolbar { flex-direction: column; align-items: stretch; }
            .filter-container, #themeToggle { width: 100%; max-width: 320px; margin: 0 auto; }
            h2 { font-size: 1.5rem; }
            .items { grid-template-columns: 1fr; }
            .card-img-container { height: 300px; }
            .btn-back-to-top { width: 40px; height: 40px; font-size: 1rem; }
        }
    </style>
</head>
<body>
    <!-- Splash Screen ‚Äî COM ANIMA√á√ÉO CSS DE SA√çDA GARANTIDA -->
    <div id="splash" class="splash">
        <h1 class="splash-title"><span class="meleka-highlight">Meleka</span> <span>Animes</span></h1>
        <p class="splash-subtitle">Carregando o universo otaku...</p>
        <div class="progress-bar">
            <div class="progress"></div>
        </div>
    </div>

    <header class="header-hq">
        <div class="logo-container">
            <h1><span class="meleka">Meleka</span> <span class="animes">Animes</span></h1>
            <p>Seu portal de animes, mang√°s e manhwas, estilo HQ!</p>
        </div>

        <!-- Bot√£o para Meleka Cinema -->
        <div class="cinema-cta">
            <a href="https://dashboardedsoncsf.netlify.app/meleka%20blogs/" target="_blank" class="btn-cinema">
                <i class="fas fa-film"></i> P√°gina Meleka Cinema
            </a>
        </div>
    </header>

    <div class="container">
        <div id="toolbar">
            <div class="filter-container">
                <select id="typeFilter" aria-label="Filtrar tipo">
                    <option value="anime">Top Animes</option>
                    <option value="manga">Top Mang√°s</option>
                    <option value="manhwa">Top Manhwas</option>
                    <option value="manhua">Top Manhuas</option>
                    <option value="season_anime">Lan√ßamentos da Temporada (Animes)</option>
                    <option value="season_manga">Lan√ßamentos da Temporada (Mang√°s)</option>
                    <option value="recent_manga">√öltimos lan√ßamentos Mang√°s</option>
                    <option value="recent_manhwa">√öltimos lan√ßamentos Manhwas</option>
                    <option value="recent_manhua">√öltimos lan√ßamentos Manhuas</option>
                    <option value="upcoming_anime">Pr√≥ximos lan√ßamentos Animes</option>
                    <option value="schedule_monday">Programa√ß√£o Segunda</option>
                    <option value="schedule_tuesday">Programa√ß√£o Ter√ßa</option>
                    <option value="schedule_wednesday">Programa√ß√£o Quarta</option>
                    <option value="schedule_thursday">Programa√ß√£o Quinta</option>
                    <option value="schedule_friday">Programa√ß√£o Sexta</option>
                    <option value="schedule_saturday">Programa√ß√£o S√°bado</option>
                    <option value="schedule_sunday">Programa√ß√£o Domingo</option>
                </select>
            </div>
            <div class="filter-container">
                <select id="sortFilter" aria-label="Ordenar por">
                    <option value="popularity">Ordenar por Popularidade</option>
                    <option value="score">Ordenar por Melhor Avalia√ß√£o</option>
                    <option value="date">Ordenar por Data</option>
                </select>
            </div>
            <button id="themeToggle" aria-label="Alternar tema">
                <i class="fas fa-moon"></i>
            </button>
        </div>

        <section>
            <h2 id="section-title">Carregando...</h2>
            <div class="items" id="items-container">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> Carregando dados...
                </div>
            </div>

            <button id="load-more" class="btn-load-more" style="display: none;">
                Carregar Mais
            </button>
        </section>
    </div>

    <!-- Bot√£o Voltar ao Topo -->
    <button class="btn-back-to-top" id="backToTop" title="Voltar ao topo">
        <i class="fas fa-arrow-up"></i>
    </button>

    <footer>
        <div class="footer-content">
            <p>¬© 2025 Meleka Animes ‚Äî Feito por Edson CSF | contato edsony1@gmail.com | vers√£o 1.2</p>
            <p>Fonte de dados: <a href="https://jikan.moe/" target="_blank" style="color: #ff3040;">Jikan API</a></p> <!-- üî¥ Link em vermelho vibrante -->
        </div>
    </footer>

    <script>
        const typeFilter = document.getElementById('typeFilter');
const sortFilter = document.getElementById('sortFilter');
const themeToggle = document.getElementById('themeToggle');
const sectionTitle = document.getElementById('section-title');
const itemsContainer = document.getElementById('items-container');
const loadMoreBtn = document.getElementById('load-more');
const backToTopBtn = document.getElementById('backToTop');

let currentPage = 1;
let currentType = 'anime';
let currentSort = 'popularity';
let hasMore = true;

// ‚úÖ ENDPOINTS CORRIGIDOS ‚Äî todos agora incluem page=1 por padr√£o
const apiUrls = {
    anime: 'https://api.jikan.moe/v4/top/anime?page=1',
    manga: 'https://api.jikan.moe/v4/top/manga?filter=bypopularity&type=manga&page=1',
    manhwa: 'https://api.jikan.moe/v4/top/manga?filter=bypopularity&type=manhwa&page=1',
    manhua: 'https://api.jikan.moe/v4/top/manga?filter=bypopularity&type=manhua&page=1',
    season_anime: 'https://api.jikan.moe/v4/seasons/now',
    season_manga: 'https://api.jikan.moe/v4/seasons/manga',
    recent_manga: 'https://api.jikan.moe/v4/manga?order_by=start_date&sort=desc&type=manga&page=1',
    recent_manhwa: 'https://api.jikan.moe/v4/manga?order_by=start_date&sort=desc&type=manhwa&page=1',
    recent_manhua: 'https://api.jikan.moe/v4/manga?order_by=start_date&sort=desc&type=manhua&page=1',
    upcoming_anime: 'https://api.jikan.moe/v4/seasons/upcoming',
    schedule_monday: 'https://api.jikan.moe/v4/schedules/monday',
    schedule_tuesday: 'https://api.jikan.moe/v4/schedules/tuesday',
    schedule_wednesday: 'https://api.jikan.moe/v4/schedules/wednesday',
    schedule_thursday: 'https://api.jikan.moe/v4/schedules/thursday',
    schedule_friday: 'https://api.jikan.moe/v4/schedules/friday',
    schedule_saturday: 'https://api.jikan.moe/v4/schedules/saturday',
    schedule_sunday: 'https://api.jikan.moe/v4/schedules/sunday',
};

// Ordena os itens
function sortItems(items, sortType) {
    return items.sort((a, b) => {
        let valueA, valueB;
        switch(sortType) {
            case 'score':
                valueA = a.score || 0;
                valueB = b.score || 0;
                break;
            case 'date':
                valueA = new Date(a.aired?.from || a.published?.from || '1970-01-01');
                valueB = new Date(b.aired?.from || b.published?.from || '1970-01-01');
                break;
            default: // popularity
                valueA = a.popularity || 0;
                valueB = b.popularity || 0;
        }
        return sortType === 'date' ? valueB - valueA : valueB - valueA;
    });
}

// ‚úÖ FUN√á√ÉO CORRIGIDA ‚Äî lida com pagina√ß√£o e fallbacks
async function fetchTopList(type, page = 1) {
    try {
        // Constr√≥i URL dinamicamente
        let baseUrl = apiUrls[type];
        
        // Remove page=1 se j√° existir, para substituir pelo n√∫mero da p√°gina atual
        if (baseUrl.includes('page=1')) {
            baseUrl = baseUrl.replace('page=1', `page=${page}`);
        } else if (!baseUrl.includes('page=')) {
            // Adiciona pagina√ß√£o se n√£o tiver
            baseUrl += baseUrl.includes('?') ? `&page=${page}` : `?page=${page}`;
        }

        console.log("Fetching URL:", baseUrl); // Para debug

        const res = await fetch(baseUrl, {
            headers: {
                'Accept': 'application/json',
                'User-Agent': 'MelekaAnimes/1.0'
            }
        });

        if (!res.ok) {
            throw new Error(`HTTP ${res.status}: ${res.statusText}`);
        }

        const json = await res.json();
        let items = [];

        // Trata diferentes formatos de resposta
        if (type === 'season_anime' && json.data?.anime) {
            items = json.data.anime;
        } else if (type === 'season_manga' && json.data?.manga) {
            items = json.data.manga;
        } else if (type.startsWith('schedule') && Array.isArray(json.data)) {
            items = json.data;
        } else if (type === 'upcoming_anime' && json.data?.anime) {
            items = json.data.anime;
        } else if (json.data && Array.isArray(json.data)) {
            items = json.data;
            // Atualiza estado de pagina√ß√£o
            hasMore = json.pagination?.has_next_page || false;
        } else {
            console.warn("Formato inesperado da API:", json);
            items = [];
            hasMore = false;
        }

        return sortItems(items, currentSort);
    } catch (e) {
        console.error('Erro ao buscar dados:', e);
        // Retorna array vazio em caso de erro, mas n√£o quebra a interface
        return [];
    }
}

// Formata data
function formatDate(dateStr) {
    if (!dateStr) return 'Desconhecida';
    try {
        const d = new Date(dateStr);
        return d.toLocaleDateString('pt-BR', { year: 'numeric', month: '2-digit', day: '2-digit' });
    } catch {
        return dateStr;
    }
}

// Renderiza cards
function renderCards(items, append = false) {
    if (!append) {
        itemsContainer.innerHTML = '';
    }

    if (!items.length && !append) {
        itemsContainer.innerHTML = '<div class="no-data">Nenhum dado dispon√≠vel. Tente novamente mais tarde.</div>';
        loadMoreBtn.style.display = 'none';
        return;
    }

    items.forEach((item, index) => {
        const title = item.title || item.name || item.entry?.title || 'Desconhecido';
        const imageUrl = item.images?.jpg?.image_url || 
                        item.images?.jpg?.large_image_url || 
                        (item.entry?.images?.jpg?.image_url) || 
                        'https://via.placeholder.com/300x400/333/fff?text=SEM+IMAGEM';
        const score = item.score || 'N/A';
        const popularity = item.popularity || 'N/A';
        const startDate = formatDate(item.aired?.from || item.published?.from || item.start_date || item.entry?.start_date) || 'Desconhecida';

        const card = document.createElement('div');
        card.className = 'card-hq';
        card.innerHTML = `
            <div class="popularity-badge">${index + 1}</div>
            <div class="card-img-container">
                <img src="${imageUrl}" alt="${title}" loading="lazy" onerror="this.src='https://via.placeholder.com/300x400/555/fff?text=Erro+Imagem'">
            </div>
            <div class="card-content">
                <h4>${title}</h4>
                <div class="card-info">
                    <p><i class="fas fa-calendar-alt"></i> ${startDate}</p>
                    <p><i class="fas fa-star"></i> Nota: ${score}</p>
                    <p><i class="fas fa-fire"></i> Popularidade: ${popularity}</p>
                </div>
            </div>
        `;
        itemsContainer.appendChild(card);

        // Anima√ß√£o GSAP
        setTimeout(() => {
            gsap.to(card, {
                duration: 0.6,
                y: 0,
                opacity: 1,
                ease: "power2.out",
                delay: index * 0.1
            });
        }, 100);
    });

    // Mostra ou esconde bot√£o de carregar mais
    loadMoreBtn.style.display = hasMore ? 'block' : 'none';
}

// Carrega dashboard
async function loadDashboard(type = 'anime', sort = 'popularity', page = 1, append = false) {
    currentType = type;
    currentSort = sort;
    currentPage = page;

    if (!append) {
        sectionTitle.textContent = `Carregando...`;
        itemsContainer.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Carregando dados...</div>';
    }

    const items = await fetchTopList(type, page);
    const displayType = type.charAt(0).toUpperCase() + type.slice(1).replace('_', ' ');
    sectionTitle.textContent = `${displayType} - Ordenado por ${sort === 'score' ? 'Melhor Avalia√ß√£o' : sort === 'date' ? 'Data' : 'Popularidade'}`;
    
    renderCards(items, append);
}

// Eventos
typeFilter.onchange = () => {
    currentPage = 1;
    loadDashboard(typeFilter.value, sortFilter.value, 1, false);
};

sortFilter.onchange = () => {
    currentPage = 1;
    loadDashboard(currentType, sortFilter.value, 1, false);
};

loadMoreBtn.onclick = () => {
    currentPage++;
    loadDashboard(currentType, currentSort, currentPage, true);
};

// Bot√£o voltar ao topo
window.addEventListener('scroll', () => {
    if (window.scrollY > 300) {
        backToTopBtn.classList.add('show');
    } else {
        backToTopBtn.classList.remove('show');
    }
});

backToTopBtn.onclick = () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
};

// Tema (opcional)
let currentTheme = 'dark';
themeToggle.onclick = () => {
    currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
    if (currentTheme === 'dark') {
        document.body.style.background = '#111 url("image/svg+xml;utf8,<svg xmlns=\\"http://www.w3.org/2000/svg\\" width=\\"100\\" height=\\"100\\" viewBox=\\"0 0 100 100\\"><rect fill=\\"%23222\\" width=\\"100\\" height=\\"100\\"/><path d=\\"M0,0 L100,100 M100,0 L0,100\\" stroke=\\"%23333\\" stroke-width=\\"1\\"/></svg>")';
        themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
    } else {
        document.body.style.background = '#f8f9fa';
        document.body.style.color = '#212529';
        themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    }
};

// Inicializa tudo
document.addEventListener('DOMContentLoaded', () => {
    // For√ßa remo√ß√£o do splash
    setTimeout(() => {
        const splash = document.getElementById('splash');
        if (splash) {
            splash.style.opacity = '0';
            splash.style.visibility = 'hidden';
            setTimeout(() => {
                if (splash.parentNode) {
                    splash.parentNode.removeChild(splash);
                }
            }, 500);
        }
        gsap.from(".logo-container h1", { duration: 1, y: -30, opacity: 0, ease: "bounce.out" });
    }, 2500);

    // ‚úÖ CARREGA "TOP ANIMES" POR PADR√ÉO
    loadDashboard('anime', 'popularity');

    window.addEventListener('scroll', () => {
        if (window.pageYOffset > 300) {
            backToTopBtn.classList.add('show');
        } else {
            backToTopBtn.classList.remove('show');
        }
    });
});
    </script>
</body>
</html>
